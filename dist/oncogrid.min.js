!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=12)}([function(t,e,r){t.exports=function(){"use strict";
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */var t=Object.prototype.toString,e=Array.isArray||function(e){return"[object Array]"===t.call(e)};function r(t){return"function"==typeof t}function n(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(t,e){return null!=t&&"object"==typeof t&&e in t}var o=RegExp.prototype.test,a=/\S/;function s(t){return!function(t,e){return o.call(t,e)}(a,t)}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,u=/\s+/,h=/\s*=/,p=/\s*\}/,f=/#|\^|\/|>|\{|&|=|!/;function d(t){this.string=t,this.tail=t,this.pos=0}function g(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function y(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}d.prototype.eos=function(){return""===this.tail},d.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var r=e[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},d.prototype.scanUntil=function(t){var e,r=this.tail.search(t);switch(r){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=e.length,e},g.prototype.push=function(t){return new g(t,this)},g.prototype.lookup=function(t){var e,n,o,a=this.cache;if(a.hasOwnProperty(t))e=a[t];else{for(var s,c,l,u=this,h=!1;u;){if(t.indexOf(".")>0)for(s=u.view,c=t.split("."),l=0;null!=s&&l<c.length;)l===c.length-1&&(h=i(s,c[l])||(n=s,o=c[l],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(o))),s=s[c[l++]];else s=u.view[t],h=i(u.view,t);if(h){e=s;break}u=u.parent}a[t]=e}return r(e)&&(e=e.call(this.view)),e},y.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},y.prototype.parse=function(t,r){var i=this.templateCache,o=t+":"+(r||m.tags).join(":"),a=void 0!==i,c=a?i.get(o):void 0;return null==c&&(c=function(t,r){if(!t)return[];var i,o,a,c=!1,g=[],y=[],v=[],b=!1,w=!1,x="",_=0;function k(){if(b&&!w)for(;v.length;)delete y[v.pop()];else v=[];b=!1,w=!1}function j(t){if("string"==typeof t&&(t=t.split(u,2)),!e(t)||2!==t.length)throw new Error("Invalid tags: "+t);i=new RegExp(n(t[0])+"\\s*"),o=new RegExp("\\s*"+n(t[1])),a=new RegExp("\\s*"+n("}"+t[1]))}j(r||m.tags);for(var O,T,C,H,S,A,G=new d(t);!G.eos();){if(O=G.pos,C=G.scanUntil(i))for(var D=0,P=C.length;D<P;++D)s(H=C.charAt(D))?(v.push(y.length),x+=H):(w=!0,c=!0,x+=" "),y.push(["text",H,O,O+1]),O+=1,"\n"===H&&(k(),x="",_=0,c=!1);if(!G.scan(i))break;if(b=!0,T=G.scan(f)||"name",G.scan(l),"="===T?(C=G.scanUntil(h),G.scan(h),G.scanUntil(o)):"{"===T?(C=G.scanUntil(a),G.scan(p),G.scanUntil(o),T="&"):C=G.scanUntil(o),!G.scan(o))throw new Error("Unclosed tag at "+G.pos);if(S=">"==T?[T,C,O,G.pos,x,_,c]:[T,C,O,G.pos],_++,y.push(S),"#"===T||"^"===T)g.push(S);else if("/"===T){if(!(A=g.pop()))throw new Error('Unopened section "'+C+'" at '+O);if(A[1]!==C)throw new Error('Unclosed section "'+A[1]+'" at '+O)}else"name"===T||"{"===T||"&"===T?w=!0:"="===T&&j(C)}if(k(),A=g.pop())throw new Error('Unclosed section "'+A[1]+'" at '+G.pos);return function(t){for(var e,r=[],n=r,i=[],o=0,a=t.length;o<a;++o)switch((e=t[o])[0]){case"#":case"^":n.push(e),i.push(e),n=e[4]=[];break;case"/":i.pop()[5]=e[2],n=i.length>0?i[i.length-1][4]:r;break;default:n.push(e)}return r}(function(t){for(var e,r,n=[],i=0,o=t.length;i<o;++i)(e=t[i])&&("text"===e[0]&&r&&"text"===r[0]?(r[1]+=e[1],r[3]=e[3]):(n.push(e),r=e));return n}(y))}(t,r),a&&i.set(o,c)),c},y.prototype.render=function(t,e,r,n){var i=this.getConfigTags(n),o=this.parse(t,i),a=e instanceof g?e:new g(e,void 0);return this.renderTokens(o,a,r,t,n)},y.prototype.renderTokens=function(t,e,r,n,i){for(var o,a,s,c="",l=0,u=t.length;l<u;++l)s=void 0,"#"===(a=(o=t[l])[0])?s=this.renderSection(o,e,r,n,i):"^"===a?s=this.renderInverted(o,e,r,n,i):">"===a?s=this.renderPartial(o,e,r,i):"&"===a?s=this.unescapedValue(o,e):"name"===a?s=this.escapedValue(o,e,i):"text"===a&&(s=this.rawValue(o)),void 0!==s&&(c+=s);return c},y.prototype.renderSection=function(t,n,i,o,a){var s=this,c="",l=n.lookup(t[1]);if(l){if(e(l))for(var u=0,h=l.length;u<h;++u)c+=this.renderTokens(t[4],n.push(l[u]),i,o,a);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)c+=this.renderTokens(t[4],n.push(l),i,o,a);else if(r(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(n.view,o.slice(t[3],t[5]),(function(t){return s.render(t,n,i,a)})))&&(c+=l)}else c+=this.renderTokens(t[4],n,i,o,a);return c}},y.prototype.renderInverted=function(t,r,n,i,o){var a=r.lookup(t[1]);if(!a||e(a)&&0===a.length)return this.renderTokens(t[4],r,n,i,o)},y.prototype.indentPartial=function(t,e,r){for(var n=e.replace(/[^ \t]/g,""),i=t.split("\n"),o=0;o<i.length;o++)i[o].length&&(o>0||!r)&&(i[o]=n+i[o]);return i.join("\n")},y.prototype.renderPartial=function(t,e,n,i){if(n){var o=this.getConfigTags(i),a=r(n)?n(t[1]):n[t[1]];if(null!=a){var s=t[6],c=t[5],l=t[4],u=a;0==c&&l&&(u=this.indentPartial(a,l,s));var h=this.parse(u,o);return this.renderTokens(h,e,n,u,i)}}},y.prototype.unescapedValue=function(t,e){var r=e.lookup(t[1]);if(null!=r)return r},y.prototype.escapedValue=function(t,e,r){var n=this.getConfigEscape(r)||m.escape,i=e.lookup(t[1]);if(null!=i)return"number"==typeof i&&n===m.escape?String(i):n(i)},y.prototype.rawValue=function(t){return t[1]},y.prototype.getConfigTags=function(t){return e(t)?t:t&&"object"==typeof t?t.tags:void 0},y.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!e(t)?t.escape:void 0};var m={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){v.templateCache=t},get templateCache(){return v.templateCache}},v=new y;return m.clearCache=function(){return v.clearCache()},m.parse=function(t,e){return v.parse(t,e)},m.render=function(t,r,n,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(e(o=t)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return v.render(t,r,n,i)},m.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return c[t]}))},m.Scanner=d,m.Context=g,m.Writer=y,m}()},function(t,e){t.exports=d3},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function o(){}function a(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),s.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t,e){var r=i?i+t:t,n=this._events[r];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var o=0,a=n.length,s=new Array(a);o<a;o++)s[o]=n[o].fn;return s},s.prototype.emit=function(t,e,r,n,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var c,l,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,o),!0;case 6:return u.fn.call(u.context,e,r,n,o,a),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,r);break;case 4:u[l].fn.call(u[l].context,e,r,n);break;default:if(!c)for(p=1,c=new Array(h-1);p<h;p++)c[p-1]=arguments[p];u[l].fn.apply(u[l].context,c)}}return!0},s.prototype.on=function(t,e,r){var n=new a(e,r||this),o=i?i+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},s.prototype.once=function(t,e,r){var n=new a(e,r||this,!0),o=i?i+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},s.prototype.removeListener=function(t,e,r,n){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return 0==--this._eventsCount?this._events=new o:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==e||n&&!s.once||r&&s.context!==r||(0==--this._eventsCount?this._events=new o:delete this._events[a]);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==e||n&&!s[c].once||r&&s[c].context!==r)&&l.push(s[c]);l.length?this._events[a]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new o:delete this._events[a]}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new o:delete this._events[e])):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=i,s.EventEmitter=s,t.exports=s},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){(function(t,r){var n="[object Arguments]",i="[object Function]",o="[object GeneratorFunction]",a="[object Map]",s="[object Set]",c=/\w*$/,l=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,h={};h[n]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object DataView]"]=h["[object Boolean]"]=h["[object Date]"]=h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h[a]=h["[object Number]"]=h["[object Object]"]=h["[object RegExp]"]=h[s]=h["[object String]"]=h["[object Symbol]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h["[object Error]"]=h[i]=h["[object WeakMap]"]=!1;var p="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,d=p||f||Function("return this")(),g=e&&!e.nodeType&&e,y=g&&"object"==typeof r&&r&&!r.nodeType&&r,m=y&&y.exports===g;function v(t,e){return t.set(e[0],e[1]),t}function b(t,e){return t.add(e),t}function w(t,e,r,n){var i=-1,o=t?t.length:0;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}function x(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function _(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function k(t,e){return function(r){return t(e(r))}}function j(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var O,T=Array.prototype,C=Function.prototype,H=Object.prototype,S=d["__core-js_shared__"],A=(O=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"",G=C.toString,D=H.hasOwnProperty,P=H.toString,L=RegExp("^"+G.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=m?d.Buffer:void 0,E=d.Symbol,z=d.Uint8Array,I=k(Object.getPrototypeOf,Object),M=Object.create,W=H.propertyIsEnumerable,N=T.splice,R=Object.getOwnPropertySymbols,B=F?F.isBuffer:void 0,U=k(Object.keys,Object),$=yt(d,"DataView"),V=yt(d,"Map"),q=yt(d,"Promise"),J=yt(d,"Set"),Y=yt(d,"WeakMap"),X=yt(Object,"create"),Z=xt($),K=xt(V),Q=xt(q),tt=xt(J),et=xt(Y),rt=E?E.prototype:void 0,nt=rt?rt.valueOf:void 0;function it(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function at(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function st(t){this.__data__=new ot(t)}function ct(t,e){var r=kt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&jt(t)}(t)&&D.call(t,"callee")&&(!W.call(t,"callee")||P.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],i=r.length,o=!!i;for(var a in t)!e&&!D.call(t,a)||o&&("length"==a||bt(a,i))||r.push(a);return r}function lt(t,e,r){var n=t[e];D.call(t,e)&&_t(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function ut(t,e){for(var r=t.length;r--;)if(_t(t[r][0],e))return r;return-1}function ht(t,e,r,l,u,p,f){var d;if(l&&(d=p?l(t,u,p,f):l(t)),void 0!==d)return d;if(!Ct(t))return t;var g=kt(t);if(g){if(d=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&D.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,d)}else{var y=vt(t),m=y==i||y==o;if(Ot(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if("[object Object]"==y||y==n||m&&!p){if(x(t))return p?t:{};if(d=function(t){return"function"!=typeof t.constructor||wt(t)?{}:(e=I(t),Ct(e)?M(e):{});var e}(m?{}:t),!e)return function(t,e){return dt(t,mt(t),e)}(t,function(t,e){return t&&dt(e,Ht(e),t)}(d,t))}else{if(!h[y])return p?t:{};d=function(t,e,r,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return ft(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return function(t,e){var r=e?ft(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var r=e?ft(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,n);case a:return function(t,e,r){return w(e?r(_(t),!0):_(t),v,new t.constructor)}(t,n,r);case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,c.exec(t));return e.lastIndex=t.lastIndex,e}(t);case s:return function(t,e,r){return w(e?r(j(t),!0):j(t),b,new t.constructor)}(t,n,r);case"[object Symbol]":return o=t,nt?Object(nt.call(o)):{}}var o}(t,y,ht,e)}}f||(f=new st);var k=f.get(t);if(k)return k;if(f.set(t,d),!g)var O=r?function(t){return function(t,e,r){var n=e(t);return kt(t)?n:function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}(n,r(t))}(t,Ht,mt)}(t):Ht(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(O||t,(function(n,i){O&&(n=t[i=n]),lt(d,i,ht(n,e,r,l,i,t,f))})),d}function pt(t){return!(!Ct(t)||(e=t,A&&A in e))&&(Tt(t)||x(t)?L:l).test(xt(t));var e}function ft(t){var e=new t.constructor(t.byteLength);return new z(e).set(new z(t)),e}function dt(t,e,r,n){r||(r={});for(var i=-1,o=e.length;++i<o;){var a=e[i],s=n?n(r[a],t[a],a,r,t):void 0;lt(r,a,void 0===s?t[a]:s)}return r}function gt(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function yt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return pt(r)?r:void 0}it.prototype.clear=function(){this.__data__=X?X(null):{}},it.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},it.prototype.get=function(t){var e=this.__data__;if(X){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return D.call(e,t)?e[t]:void 0},it.prototype.has=function(t){var e=this.__data__;return X?void 0!==e[t]:D.call(e,t)},it.prototype.set=function(t,e){return this.__data__[t]=X&&void 0===e?"__lodash_hash_undefined__":e,this},ot.prototype.clear=function(){this.__data__=[]},ot.prototype.delete=function(t){var e=this.__data__,r=ut(e,t);return!(r<0)&&(r==e.length-1?e.pop():N.call(e,r,1),!0)},ot.prototype.get=function(t){var e=this.__data__,r=ut(e,t);return r<0?void 0:e[r][1]},ot.prototype.has=function(t){return ut(this.__data__,t)>-1},ot.prototype.set=function(t,e){var r=this.__data__,n=ut(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},at.prototype.clear=function(){this.__data__={hash:new it,map:new(V||ot),string:new it}},at.prototype.delete=function(t){return gt(this,t).delete(t)},at.prototype.get=function(t){return gt(this,t).get(t)},at.prototype.has=function(t){return gt(this,t).has(t)},at.prototype.set=function(t,e){return gt(this,t).set(t,e),this},st.prototype.clear=function(){this.__data__=new ot},st.prototype.delete=function(t){return this.__data__.delete(t)},st.prototype.get=function(t){return this.__data__.get(t)},st.prototype.has=function(t){return this.__data__.has(t)},st.prototype.set=function(t,e){var r=this.__data__;if(r instanceof ot){var n=r.__data__;if(!V||n.length<199)return n.push([t,e]),this;r=this.__data__=new at(n)}return r.set(t,e),this};var mt=R?k(R,Object):function(){return[]},vt=function(t){return P.call(t)};function bt(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||u.test(t))&&t>-1&&t%1==0&&t<e}function wt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||H)}function xt(t){if(null!=t){try{return G.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function _t(t,e){return t===e||t!=t&&e!=e}($&&"[object DataView]"!=vt(new $(new ArrayBuffer(1)))||V&&vt(new V)!=a||q&&"[object Promise]"!=vt(q.resolve())||J&&vt(new J)!=s||Y&&"[object WeakMap]"!=vt(new Y))&&(vt=function(t){var e=P.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?xt(r):void 0;if(n)switch(n){case Z:return"[object DataView]";case K:return a;case Q:return"[object Promise]";case tt:return s;case et:return"[object WeakMap]"}return e});var kt=Array.isArray;function jt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&!Tt(t)}var Ot=B||function(){return!1};function Tt(t){var e=Ct(t)?P.call(t):"";return e==i||e==o}function Ct(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Ht(t){return jt(t)?ct(t):function(t){if(!wt(t))return U(t);var e=[];for(var r in Object(t))D.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}r.exports=function(t){return ht(t,!0,!0)}}).call(this,r(3),r(8)(t))},function(t,e,r){(function(e){var r=/^\[object .+?Constructor\]$/,n="object"==typeof e&&e&&e.Object===Object&&e,i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();function a(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var i=t.length,o=r+(n?1:-1);for(;n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,c,r);var n=r-1,i=t.length;for(;++n<i;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function s(t,e,r){for(var n=-1,i=t?t.length:0;++n<i;)if(r(e,t[n]))return!0;return!1}function c(t){return t!=t}function l(t,e){return t.has(e)}function u(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var h,p=Array.prototype,f=Function.prototype,d=Object.prototype,g=o["__core-js_shared__"],y=(h=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",m=f.toString,v=d.hasOwnProperty,b=d.toString,w=RegExp("^"+m.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=p.splice,_=P(o,"Map"),k=P(o,"Set"),j=P(Object,"create");function O(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function T(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function C(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function H(t){var e=-1,r=t?t.length:0;for(this.__data__=new C;++e<r;)this.add(t[e])}function S(t,e){for(var r,n,i=t.length;i--;)if((r=t[i][0])===(n=e)||r!=r&&n!=n)return i;return-1}function A(t){return!(!L(t)||(e=t,y&&y in e))&&(function(t){var e=L(t)?b.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?w:r).test(function(t){if(null!=t){try{return m.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}O.prototype.clear=function(){this.__data__=j?j(null):{}},O.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},O.prototype.get=function(t){var e=this.__data__;if(j){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return v.call(e,t)?e[t]:void 0},O.prototype.has=function(t){var e=this.__data__;return j?void 0!==e[t]:v.call(e,t)},O.prototype.set=function(t,e){return this.__data__[t]=j&&void 0===e?"__lodash_hash_undefined__":e,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(t){var e=this.__data__,r=S(e,t);return!(r<0)&&(r==e.length-1?e.pop():x.call(e,r,1),!0)},T.prototype.get=function(t){var e=this.__data__,r=S(e,t);return r<0?void 0:e[r][1]},T.prototype.has=function(t){return S(this.__data__,t)>-1},T.prototype.set=function(t,e){var r=this.__data__,n=S(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},C.prototype.clear=function(){this.__data__={hash:new O,map:new(_||T),string:new O}},C.prototype.delete=function(t){return D(this,t).delete(t)},C.prototype.get=function(t){return D(this,t).get(t)},C.prototype.has=function(t){return D(this,t).has(t)},C.prototype.set=function(t,e){return D(this,t).set(t,e),this},H.prototype.add=H.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},H.prototype.has=function(t){return this.__data__.has(t)};var G=k&&1/u(new k([,-0]))[1]==1/0?function(t){return new k(t)}:function(){};function D(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function P(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return A(r)?r:void 0}function L(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=function(t){return t&&t.length?function(t,e,r){var n=-1,i=a,o=t.length,c=!0,h=[],p=h;if(r)c=!1,i=s;else if(o>=200){var f=e?null:G(t);if(f)return u(f);c=!1,i=l,p=new H}else p=e?[]:h;t:for(;++n<o;){var d=t[n],g=e?e(d):d;if(d=r||0!==d?d:0,c&&g==g){for(var y=p.length;y--;)if(p[y]===g)continue t;e&&p.push(g),h.push(d)}else i(p,g,r)||(p!==h&&p.push(g),h.push(d))}return h}(t):[]}}).call(this,r(3))},function(t,e){var r=/^(?:0|[1-9]\d*)$/;function n(t,e){return function(t,e){for(var r=-1,n=t?t.length:0,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}(e,(function(e){return t[e]}))}var i,o,a=Object.prototype,s=a.hasOwnProperty,c=a.toString,l=a.propertyIsEnumerable,u=(i=Object.keys,o=Object,function(t){return i(o(t))});function h(t,e){var r=d(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&g(t)}(t)&&s.call(t,"callee")&&(!l.call(t,"callee")||"[object Arguments]"==c.call(t))}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,i=!!n;for(var o in t)!e&&!s.call(t,o)||i&&("length"==o||f(o,n))||r.push(o);return r}function p(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||a,e!==n)return u(t);var e,r,n,i=[];for(var o in Object(t))s.call(t,o)&&"constructor"!=o&&i.push(o);return i}function f(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||r.test(t))&&t>-1&&t%1==0&&t<e}var d=Array.isArray;function g(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?c.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)}t.exports=function(t){return t?n(t,function(t){return g(t)?h(t):p(t)}(t)):[]}},function(t,e,r){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++)r[e[n]]=Object.getOwnPropertyDescriptor(t,e[n]);return r},i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(s(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}})),c=n[r];r<o;c=n[++r])g(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},e.deprecate=function(r,n){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var o,a={};function s(t,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(r)?n.showHidden=r:r&&e._extend(n,r),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),u(n,t,n.depth)}function c(t,e){var r=s.styles[e];return r?"["+s.colors[r][0]+"m"+t+"["+s.colors[r][1]+"m":t}function l(t,e){return t}function u(t,r,n){if(t.customInspect&&r&&k(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return m(i)||(i=u(t,i,n)),i}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(m(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(y(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,r);if(o)return o;var a=Object.keys(r),s=function(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),_(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(r);if(0===a.length){if(k(r)){var c=r.name?": "+r.name:"";return t.stylize("[Function"+c+"]","special")}if(b(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return t.stylize(Date.prototype.toString.call(r),"date");if(_(r))return h(r)}var l,w="",j=!1,O=["{","}"];(f(r)&&(j=!0,O=["[","]"]),k(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),x(r)&&(w=" "+Date.prototype.toUTCString.call(r)),_(r)&&(w=" "+h(r)),0!==a.length||j&&0!=r.length?n<0?b(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),l=j?function(t,e,r,n,i){for(var o=[],a=0,s=e.length;a<s;++a)H(e,String(a))?o.push(p(t,e,r,n,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(t,e,r,n,i,!0))})),o}(t,r,n,s,a):a.map((function(e){return p(t,r,n,s,e,j)})),t.seen.pop(),function(t,e,r){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(l,w,O)):O[0]+w+O[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,r,n,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),H(n,i)||(a="["+i+"]"),s||(t.seen.indexOf(c.value)<0?(s=g(r)?u(t,c.value,null):u(t,c.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===j(t)}function w(t){return"object"==typeof t&&null!==t}function x(t){return w(t)&&"[object Date]"===j(t)}function _(t){return w(t)&&("[object Error]"===j(t)||t instanceof Error)}function k(t){return"function"==typeof t}function j(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(v(o)&&(o=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(o)){var n=t.pid;a[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,n,t)}}else a[r]=function(){};return a[r]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=w,e.isDate=x,e.isError=_,e.isFunction=k,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(10);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}function H(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=r(11),e._extend=function(t,e){if(!e||!w(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};var S="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(S&&t[S]){var e;if("function"!=typeof(e=t[S]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,S,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,n=new Promise((function(t,n){e=t,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,n){t?r(t):e(n)}));try{t.apply(this,i)}catch(t){r(t)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),S&&Object.defineProperty(e,S,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,n(t))},e.promisify.custom=S,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,r).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(A,e,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,n(e)),r}}).call(this,r(9))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var c,l=[],u=!1,h=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var t=s(p);u=!0;for(var e=l.length;e;){for(c=l,l=[];++h<e;)c&&c[h].run();h=-1,e=l.length}c=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new d(t,e)),1!==l.length||u||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";r.r(e);r(1);var n=r(4),i=r.n(n),o=r(0),a=r.n(o);let s=function(t,e,r){let n=t.histogramBorderPadding||{};this.lineWidthOffset=n.left||10,this.lineHeightOffset=n.bottom||5,this.padding=20,this.centerText=-6,this.prefix=t.prefix||"og-",this.observations=t.observations,this.svg=e,this.rotated=r||!1,this.domain=(this.rotated?t.genes:t.donors)||[],this.margin=t.margin||{top:30,right:15,bottom:15,left:80},this.clickFunc=this.rotated?t.geneHistogramClick:t.donorHistogramClick,this.width=t.width||500,this.height=t.height||500,this.histogramWidth=this.rotated?this.height:this.width,this.histogramHeight=80,this.numDomain=this.domain.length,this.barWidth=(this.rotated?this.height:this.width)/this.domain.length,this.totalHeight=this.histogramHeight+this.lineHeightOffset+this.padding,this.wrapper=d3.select(t.wrapper||"body")};s.prototype.render=function(t,e){let r=this;r.x=t,r.div=e;let n=function(){let t=1;for(let e=0;e<r.domain.length;e++){let n=r.domain[e];t=Math.max(t,n.count)}return t}();r.container=r.svg.append("g").attr("class",r.prefix+"histogram").attr("width",(function(){return r.rotated?r.height:r.width+r.margin.left+r.margin.right})).attr("height",r.histogramHeight).style("margin-left",r.margin.left+"px").attr("transform",(function(){return r.rotated?"rotate(90)translate(0,-"+r.width+")":""})),r.histogram=r.container.append("g").attr("transform","translate(0,-"+(r.totalHeight+r.centerText)+")"),r.renderAxis(n),r.histogram.selectAll("rect").data(r.domain).enter().append("rect").on("mouseover",(function(t,e){let n=d3.pointer(t,r.wrapper.node());r.div.transition().duration(200).style("opacity",.9),r.div.html((function(){return r.rotated?e.symbol+"<br/> Count:"+e.count+"<br/>":e.id+"<br/> Count:"+e.count+"<br/>"})).style("left",n[0]+10+"px").style("top",n[1]-28+"px")})).on("mouseout",(function(){r.div.transition().duration(500).style("opacity",0)})).on("click",r.clickFunc).attr("class",(function(t){return r.prefix+"sortable-bar "+r.prefix+t.id+"-bar"})).attr("width",r.barWidth-(r.barWidth<3?0:1)).attr("height",(function(t){return r.histogramHeight*t.count/n})).attr("x",(function(t){return r.x(r.getIndex(r.domain,t.id))})).attr("y",(function(t){return r.histogramHeight-r.histogramHeight*t.count/n})).attr("fill","#1693C0")},s.prototype.update=function(t,e){let r=this;r.x=e,r.domain=t,r.barWidth=(r.rotated?r.height:r.width)/r.domain.length,r.histogram.selectAll("rect").transition().attr("width",r.barWidth-(r.barWidth<3?0:1)).attr("x",(function(t){return r.x(r.getIndex(r.domain,t.id))}))},s.prototype.resize=function(t,e){let r=this;r.width=t,r.height=e,r.histogramWidth=r.rotated?r.height:r.width,r.container.attr("width",(function(){return r.rotated?r.height:r.width+r.margin.left+r.margin.right})).attr("transform",(function(){return r.rotated?"rotate(90)translate(0,-"+r.width+")":""})),r.histogram.attr("transform","translate(0,-"+(r.totalHeight+r.centerText)+")"),r.bottomAxis.attr("x2",r.histogramWidth+10)},s.prototype.renderAxis=function(t){let e=this;e.bottomAxis=e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",e.histogramHeight+e.lineHeightOffset).attr("y2",e.histogramHeight+e.lineHeightOffset).attr("x2",e.histogramWidth+e.lineWidthOffset).attr("transform","translate(-"+e.lineHeightOffset+",0)"),e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",0).attr("y2",e.histogramHeight+e.lineHeightOffset).attr("transform","translate(-"+e.lineHeightOffset+",0)"),e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",e.centerText).attr("dy",".32em").attr("text-anchor","end").text(t);let r=parseInt(t/2),n=e.histogramHeight-e.histogramHeight/(t/r);e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",e.centerText).attr("y",n).attr("dy",".32em").attr("text-anchor","end").text(r);let i=e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("dy",".32em").attr("text-anchor","end").text("Mutation freq.");i.each((function(){let t=this.getBBox().width;i.attr("transform","rotate(-90)translate("+-(e.histogramHeight-t)+","+-(e.lineHeightOffset+e.padding)+")")}))},s.prototype.getIndex=function(t,e){for(let r=0;r<t.length;r++){if(t[r].id===e)return r}return-1},s.prototype.destroy=function(){this.histogram.remove(),this.container.remove()};var c=s,l=r(5),u=r.n(l);let h=function(t,e,r,n,i,o,a,s){this.prefix=t.prefix||"og-",this.expandable=t.expandable,this.name=e,this.cellHeight=t.cellHeight||20,this.height=0,this.totalHeight=0,this.width=t.width,this.tracks=[],this.collapsedTracks=[],this.length=0,this.nullSentinel=t.nullSentinel||-777,this.isFullscreen=s,this.rotated=r,this.updateCallback=o,this.resizeCallback=a,this.trackLegend=t.trackLegend,this.trackLegendLabel=t.trackLegendLabel,this.clickFunc=t.clickFunc,this.opacityFunc=n,this.fillFunc=i,this.addTrackFunc=t.addTrackFunc||function(t,e){e(t[0])},this.drawGridLines=t.grid||!1,this.domain=t.domain,this.numDomain=this.domain.length,this.trackData=[],this.wrapper=d3.select(t.wrapper||"body")};h.prototype.addTrack=function(t){let e=this;t=Array.isArray(t)?t:[t];for(var r,n=0;n<t.length;n++)r=t[n],!e.rendered&&r.collapsed&&e.expandable?e.collapsedTracks.push(r):e.tracks.push(r);e.collapsedTracks=e.collapsedTracks.filter((function(t){return!e.tracks.some((function(e){return _.isEqual(t,e)}))})),e.tracks=u()(e.tracks,"fieldName"),e.length=e.tracks.length,e.height=e.cellHeight*e.length,e.rendered&&(e.refreshData(),e.resizeCallback())},h.prototype.removeTrack=function(t){let e=this.tracks.splice(t,1);this.collapsedTracks=this.collapsedTracks.concat(e),this.length=this.tracks.length,this.refreshData(),this.resizeCallback()},h.prototype.refreshData=function(){let t=this;t.trackData=[];for(var e,r=0;r<t.domain.length;r++){e=t.domain[r];for(var n,i,o=0;o<t.length;o++){let r=(i=e[(n=t.tracks[o]).fieldName])===t.nullSentinel;t.trackData.push({id:e.id,displayId:t.rotated?e.symbol:e.id,value:i,displayValue:r?"Not Verified":i,notNullSentinel:!r,displayName:n.name,fieldName:n.fieldName,type:n.type,template:n.template||"{{displayId}}<br>{{displayName}}: {{displayValue}}"})}}},h.prototype.init=function(t){this.container=t,this.label=this.container.append("text").attr("x",-6).attr("y",-11).attr("dy",".32em").attr("text-anchor","end").attr("class",this.prefix+"track-group-label").text(this.name),this.legendObject=this.container.append("svg:foreignObject").attr("width",20).attr("height",20),this.legend=this.legendObject.attr("x",0).attr("y",-22).append("xhtml:div").html(this.trackLegendLabel),this.background=this.container.append("rect").attr("class","background").attr("width",this.width).attr("height",this.height),this.refreshData(),this.totalHeight=this.height+(this.collapsedTracks.length?this.cellHeight:0)},h.prototype.render=function(t,e){let r=this;r.rendered=!0,r.x=t,r.div=e,r.computeCoordinates(),r.cellWidth=r.width/r.domain.length,r.renderData(),r.legend.on("mouseover",(function(t){let e=d3.pointer(t,r.wrapper.node());r.div.transition().duration(200).style("opacity",.9),r.div.html((function(){return r.trackLegend})).style("left",e[0]+15+"px").style("top",e[1]+30+"px")})).on("mouseout",(function(){r.div.transition().duration(500).style("opacity",0)}))},h.prototype.update=function(t,e){let r=this;r.domain=t,r.x=e,r.domain.length!==r.numDomain&&(r.numDomain=r.domain.length,r.cellWidth=r.width/r.numDomain,r.computeCoordinates()),r.container.selectAll("."+r.prefix+"track-data").transition().attr("x",(function(t){return r.getX(t)})).attr("width",r.cellWidth)},h.prototype.resize=function(t,e){this.width=t,this.x=e,this.height=this.cellHeight*this.length,this.collapsedTracks.length&&(this.totalHeight=this.height+this.cellHeight),this.cellWidth=this.width/this.domain.length,this.background.attr("class","background").attr("width",this.width).attr("height",this.height),this.computeCoordinates(),this.totalHeight=this.height+(this.collapsedTracks.length?this.cellHeight:0),this.renderData()},h.prototype.computeCoordinates=function(){let t=this;t.y=d3.scaleBand().domain(d3.range(t.length)).range([0,t.height]),void 0!==t.column&&t.column.remove(),t.column=t.container.selectAll("."+t.prefix+"column").data(t.domain).enter().append("g").attr("class",t.prefix+"column").attr("donor",(function(t){return t.id})).attr("transform",(function(e,r){return"translate("+t.x(r)+")rotate(-90)"})),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),void 0!==t.row&&t.row.remove(),t.row=t.container.selectAll("."+t.prefix+"row").data(t.tracks).enter().append("g").attr("class",t.prefix+"row").attr("transform",(function(e,r){return"translate(0,"+t.y(r)+")"})),t.drawGridLines&&t.row.append("line").attr("x2",t.width);let e=t.row.append("text");e.attr("class",t.prefix+"track-label "+t.prefix+"label-text-font").on("click",(function(e,r){t.domain.sort(r.sort(r.fieldName)),t.updateCallback(!1)})).transition().attr("x",-6).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").text((function(e,r){return t.tracks[r].name})),t.container.selectAll("."+t.prefix+"remove-track").remove(),t.expandable&&setTimeout((function(){let r={};e.each((function(t){r[t.name]=this.getComputedTextLength()})),t.row.append("text").attr("class","remove-track").text("-").attr("y",t.cellHeight/2).attr("dy",".32em").on("click",(function(e,r,n){t.removeTrack(n)})).attr("x",(function(t){return-(r[t.name]+12+this.getComputedTextLength())}))}));let r=t.container.selectAll("."+t.prefix+"add-track");t.collapsedTracks.length&&t.expandable?(r.empty()&&(r=t.container.append("text").text("+").attr("class",t.prefix+"add-track").attr("x",-6).attr("dy",".32em").attr("text-anchor","end").on("click",(function(){t.addTrackFunc(t.collapsedTracks.slice(),t.addTrack.bind(t))}))),r.attr("y",t.cellHeight/2+(t.length&&t.cellHeight+t.y(t.length-1)))):r.remove()},h.prototype.getX=function(t){let e=this.domain.map((function(t){return t.id}));return this.x(e.indexOf(t.id))},h.prototype.getY=function(t){let e=this.tracks.map((function(t){return t.fieldName}));return this.y(e.indexOf(t.fieldName))},h.prototype.toggleGridLines=function(){this.drawGridLines=!this.drawGridLines,this.computeCoordinates()},h.prototype.renderData=function(t,e){let r=this,n=r.container.selectAll("."+r.prefix+"track-data").data(r.trackData);n.enter().append("rect"),n.attr("x",(function(t){return r.getX(t)})).attr("y",(function(t){return r.getY(t)})).attr("width",r.cellWidth).attr("height",r.cellHeight).attr("fill",r.fillFunc).attr("opacity",r.opacityFunc).attr("class",(function(t){return r.prefix+"track-data "+r.prefix+"track-"+t.fieldName+" "+r.prefix+"track-"+t.value+" "+r.prefix+t.id+"-cell"})).on("click",(function(t,e){r.clickFunc(t,e)})).on("mouseover",(function(t,e){let n=d3.pointer(t,r.wrapper.node());r.div.transition().duration(200).style("opacity",.9),r.div.html(a.a.render(e.template,e)).style("left",n[0]+15+"px").style("top",n[1]+30+"px")})).on("mouseout",(function(){r.div.transition().duration(500).style("opacity",0)})),n.exit().remove()};var p=h;let f=function(t,e,r,n,i,o,a,s,c,l){this.padding=t.trackPadding||20,this.offset=s,this.params=t,this.prefix=t.prefix||"og-",this.svg=e,this.rotated=r||!1,this.updateCallback=a,this.resizeCallback=c,this.expandableGroups=t.expandableGroups||[],this.addTrackFunc=t.addTrackFunc,this.isFullscreen=l,this.trackLegends=t.trackLegends||{},this.trackLegendLabel=t.trackLegendLabel,this.clickFunc=this.rotated?t.geneClick:t.donorClick,this.margin=t.margin||{top:30,right:15,bottom:15,left:80},this.domain=(this.rotated?t.genes:t.donors)||[],this.width=(this.rotated?t.height:t.width)||500,this.cellHeight=t.trackHeight||10,this.numDomain=this.domain.length,this.cellWidth=this.width/this.numDomain,this.availableTracks=n||[],this.opacityFunc=i,this.fillFunc=o,this.drawGridLines=t.grid||!1,this.nullSentinel=t.nullSentinel||-777,this.parseGroups()};f.prototype.parseGroups=function(){let t=this;t.groupMap={},t.groups=[],t.availableTracks.forEach((function(e){let r=e.group||"Tracks";if(t.groupMap.hasOwnProperty(r))t.groupMap[r].addTrack(e);else{let n=new p({cellHeight:t.cellHeight,width:t.width,clickFunc:t.clickFunc,grid:t.drawGridLines,nullSentinel:t.nullSentinel,domain:t.domain,trackLegend:t.trackLegends[r]||"",trackLegendLabel:t.trackLegendLabel,expandable:t.expandableGroups.indexOf(r)>=0,addTrackFunc:t.addTrackFunc,wrapper:t.params.wrapper},r,t.rotated,t.opacityFunc,t.fillFunc,t.updateCallback,t.resizeCallback,t.isFullscreen);n.addTrack(e),t.groupMap[r]=n,t.groups.push(n)}}))},f.prototype.init=function(){let t=this;t.container=t.svg.append("g");let e=0;t.height=0;for(let r=0;r<t.groups.length;r++){let n=t.groups[r],i=t.container.append("g").attr("transform","translate(0,"+t.height+")");n.init(i),t.height+=Number(n.totalHeight)+t.padding,t.rotated&&n.label.each((function(){e=Math.max(e,this.getBBox().height)}))}let r=t.rotated?-(t.offset+t.height):t.padding+t.offset;t.container.attr("width",t.width).attr("height",t.height).attr("class",t.prefix+"track").attr("transform",(function(){return(t.rotated?"rotate(90)":"")+"translate(0,"+r+")"})),t.height+=e},f.prototype.render=function(t,e){let r=this;for(let n=0;n<r.groups.length;n++){r.groups[n].render(t,e)}},f.prototype.resize=function(t,e,r,n){let i=this;i.offset=n||i.offset,i.width=i.rotated?e:t,i.height=0;let o=0;for(let t=0;t<i.groups.length;t++){let e=i.groups[t];e.container.attr("transform","translate(0,"+i.height+")"),e.resize(i.width,r),i.height+=Number(e.totalHeight)+i.padding,i.rotated&&e.label.each((function(){o=Math.max(o,this.getBBox().height)}))}let a=i.rotated?-(i.offset+i.height):i.padding+i.offset;i.container.attr("width",i.width).attr("height",i.height).attr("transform",(function(){return(i.rotated?"rotate(90)":"")+"translate(0,"+a+")"})),i.height+=o},f.prototype.update=function(t,e){let r=this;r.domain=t,r.x=e;for(let n=0;n<r.groups.length;n++){r.groups[n].update(t,e)}},f.prototype.toggleGridLines=function(){let t=this;for(let e=0;e<t.groups.length;e++){t.groups[e].toggleGridLines()}};var d=f;let g=function(t,e,r,n,i){this.emit=i,this.lookupTable=e,this.updateCallback=r,this.resizeCallback=n,this.loadParams(t),this.init(),this.donorHistogram=new c(t,this.container,!1),this.histogramHeight=this.donorHistogram.totalHeight,this.donorTrack=new d(t,this.container,!1,t.donorTracks,t.donorOpacityFunc,t.donorFillFunc,r,this.height,this.resizeCallback,this.isFullscreen),this.donorTrack.init(),this.geneHistogram=new c(t,this.container,!0),this.geneTrack=new d(t,this.container,!0,t.geneTracks,t.geneOpacityFunc,t.geneFillFunc,r,this.width+this.histogramHeight,this.resizeCallback,this.isFullscreen),this.geneTrack.init()};g.prototype.loadParams=function(t){let e=this;e.scaleToFit="boolean"!=typeof t.scaleToFit||t.scaleToFit,e.leftTextWidth=t.leftTextWidth||80,e.prefix=t.prefix||"og-",e.minCellHeight=t.minCellHeight||10,e.donors=t.donors||[],e.genes=t.genes||[],e.observations=t.observations||[],e.wrapper=d3.select(t.wrapper||"body"),e.colorMap=t.colorMap||{missense_variant:"#ff9b6c",frameshift_variant:"#57dba4",stop_gained:"#af57db",start_lost:"#ff2323",stop_lost:"#d3ec00",initiator_codon_variant:"#5abaff"},e.numDonors=e.donors.length,e.numGenes=e.genes.length,e.fullscreen=!1,e.isFullscreen=function(){return e.fullscreen},e.width=t.width||500,e.height=t.height||500,e.inputWidth=t.width||500,e.inputHeight=t.height||500,e.cellWidth=e.width/e.donors.length,e.cellHeight=e.height/e.genes.length,e.cellHeight<e.minCellHeight&&(e.cellHeight=e.minCellHeight,t.height=e.numGenes*e.minCellHeight,e.height=t.height),e.margin=t.margin||{top:30,right:100,bottom:15,left:80},e.heatMap=t.heatMap,e.drawGridLines=t.grid||!1,e.crosshair=!1,e.gridClick=t.gridClick;let r=t.templates||{};e.templates={mainGrid:r.mainGrid||"{{#observation}}{{observation.id}}<br>{{observation.geneSymbol}}<br>{{observation.donorId}}<br>{{observation.consequence}}<br>{{/observation}}",mainGridCrosshair:r.mainGridCrosshair||"{{#donor}}Donor: {{donor.id}}<br>{{/donor}}{{#gene}}Gene: {{gene.symbol}}<br>{{/gene}}{{#obs}}Mutations: {{obs}}<br>{{/obs}}"}},g.prototype.init=function(){this.div=this.wrapper.append("div").attr("class",this.prefix+"tooltip-oncogrid").style("opacity",0),this.canvas=this.wrapper.append("canvas").attr("class",this.prefix+"canvas"),this.svg=this.wrapper.append("svg").attr("class",this.prefix+"maingrid-svg").attr("id",this.prefix+"maingrid-svg").attr("width","100%").style("position","absolute").style("top",0).style("left",0),this.container=this.svg.append("g"),this.background=this.container.append("rect").attr("class","background").attr("width",this.width).attr("height",this.height)},g.prototype.render=function(){let t=this;t.emit("render:mainGrid:start"),t.computeCoordinates(),t.container.selectAll("."+t.prefix+"maingrid-svg").data(t.observations).enter().append("rect").on("mouseover",(function(e,r){let n=d3.pointer(e),i=t.rangeToDomain(t.x,n[0]),o=t.rangeToDomain(t.y,n[1]),s=t.crosshair?t.templates.mainGridCrosshair:t.templates.mainGrid,c=a.a.render(s||"",{observation:r,donor:t.donors[i],gene:t.genes[o]});if(c){let r=d3.pointer(e,t.wrapper.node());t.div.transition().duration(200).style("opacity",.9),t.div.html(c).style("left",r[0]+15+"px").style("top",r[1]+30+"px")}})).on("mouseout",(function(){t.div.transition().duration(500).style("opacity",0)})).on("click",(function(e,r){void 0!==t.gridClick&&t.gridClick(e,r)})).attr("class",(function(e){return t.prefix+"sortable-rect "+t.prefix+e.donorId+"-cell "+t.prefix+e.geneId+"-cell"})).attr("cons",(function(t){return t.consequence})).attr("x",(function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))})).attr("y",(function(e){return t.getY(e)})).attr("width",t.cellWidth).attr("height",(function(e){return t.getHeight(e)})).attr("fill",(function(e){return t.getColor(e)})).attr("opacity",(function(e){return t.getOpacity(e)})).attr("stroke-width",2),t.emit("render:mainGrid:end"),t.emit("render:donorHisogram:start"),t.donorHistogram.render(t.x,t.div),t.emit("render:donorHisogram:end"),t.emit("render:donorTrack:start"),t.donorTrack.render(t.x,t.div),t.emit("render:donorTrack:end"),t.emit("render:geneHistogram:start"),t.geneHistogram.render(t.y,t.div),t.emit("render:geneHistogram:end"),t.emit("render:geneTrack:start"),t.geneTrack.render(t.y,t.div),t.emit("render:geneTrack:end"),t.defineCrosshairBehaviour(),t.resizeSvg()},g.prototype.update=function(){let t=this;t.numDonors!==t.donors.length||t.numGenes!==t.genes.length?(t.numDonors=t.donors.length,t.numGenes=t.genes.length,t.cellWidth=t.width/t.numDonors,t.cellHeight=t.height/t.numGenes,t.computeCoordinates()):t.row.selectAll("text").attr("style",(function(){return t.cellHeight<t.minCellHeight?"display: none;":""})),t.row.transition().attr("transform",(function(e){return"translate( 0, "+t.y(t.genes.indexOf(e))+")"})),t.container.selectAll("."+t.prefix+"sortable-rect").transition().attr("width",t.cellWidth).attr("height",(function(e){return t.getHeight(e)})).attr("y",(function(e){return t.getY(e)})).attr("x",(function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))})),t.donorHistogram.update(t.donors,t.x),t.donorTrack.update(t.donors,t.x),t.geneHistogram.update(t.genes,t.y),t.geneTrack.update(t.genes,t.y)},g.prototype.computeCoordinates=function(){let t=this;t.x=d3.scaleBand().domain(d3.range(t.donors.length)).range([0,t.width]),t.cellWidth=t.width/t.donors.length,void 0!==t.column&&t.column.remove(),t.column=t.container.selectAll("."+t.prefix+"donor-column").data(t.donors).enter().append("g").attr("class",t.prefix+"donor-column").attr("donor",(function(t){return t.id})).attr("transform",(function(e,r){return"translate("+t.x(r)+")rotate(-90)"})),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),t.y=d3.scaleBand().domain(d3.range(t.genes.length)).range([0,t.height]),t.cellHeight=t.height/t.genes.length,void 0!==t.row&&t.row.remove(),t.row=t.container.selectAll("."+t.prefix+"gene-row").data(t.genes).enter().append("g").attr("class",t.prefix+"gene-row").attr("transform",(function(e,r){return"translate(0,"+t.y(r)+")"})),t.drawGridLines&&t.row.append("line").attr("x2",t.width),t.row.append("text").attr("class",(function(e){return t.prefix+e.id+"-label "+t.prefix+"gene-label "+t.prefix+"label-text-font"})).attr("x",-8).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").attr("style",(function(){return t.cellHeight<t.minCellHeight?"display: none;":""})).text((function(e,r){return t.genes[r].symbol})),t.defineRowDragBehaviour()},g.prototype.resize=function(t,e){let r=this;r.width=t,r.height=e,r.cellWidth=r.width/r.donors.length,r.cellHeight=r.height/r.genes.length,r.cellHeight<r.minCellHeight&&(r.cellHeight=r.minCellHeight,r.height=r.genes.length*r.minCellHeight),r.background.attr("width",r.width).attr("height",r.height),r.computeCoordinates(),r.donorHistogram.resize(t,r.height),r.donorTrack.resize(t,r.height,r.x,r.height),r.geneHistogram.resize(t,r.height),r.geneTrack.resize(t,r.height,r.y,r.width+r.histogramHeight),r.resizeSvg(),r.update();let n=r.container.node().getBBox();r.verticalCross.attr("y2",n.height),r.horizontalCross.attr("x2",n.width)},g.prototype.resizeSvg=function(){let t=this,e=t.margin.left+t.leftTextWidth+t.width+t.histogramHeight+t.geneTrack.height+t.margin.right,r=t.margin.top+t.histogramHeight+t.height+t.donorTrack.height+t.margin.bottom;t.canvas.attr("width",e).attr("height",r),t.scaleToFit?(t.canvas.style("width","100%"),t.svg.attr("viewBox","0 0 "+e+" "+r)):(t.canvas.style("width",e+"px"),t.svg.attr("width",e).attr("height",r)),t.container.attr("transform","translate("+(t.margin.left+t.leftTextWidth)+","+(t.margin.top+t.histogramHeight)+")")},g.prototype.defineCrosshairBehaviour=function(){let t=this,e=function(e,r){if(t.crosshair){let n=d3.pointer(r);t.verticalCross.attr("x1",n[0]).attr("opacity",1),t.verticalCross.attr("x2",n[0]).attr("opacity",1),t.horizontalCross.attr("y1",n[1]).attr("opacity",1),t.horizontalCross.attr("y2",n[1]).attr("opacity",1),"mousemove"===e&&void 0!==t.selectionRegion&&t.changeSelection(n);let i=t.width<n[0]?-1:t.rangeToDomain(t.x,n[0]),o=t.height<n[1]?-1:t.rangeToDomain(t.y,n[1]),s=t.donors[i],c=t.genes[o],l=t.nullableObsLookup(s,c),u=a.a.render(t.templates.mainGridCrosshair,{donor:s,gene:c,obs:l});if(u){let e=d3.pointer(r,t.wrapper.node());t.div.transition().duration(200).style("opacity",.9),t.div.html(u).style("left",e[0]+15+"px").style("top",e[1]+30+"px")}}};t.verticalCross=t.container.append("line").attr("class",t.prefix+"vertical-cross").attr("y1",-t.histogramHeight).attr("y2",t.height+t.donorTrack.height).attr("opacity",0).attr("style","pointer-events: none"),t.horizontalCross=t.container.append("line").attr("class",t.prefix+"horizontal-cross").attr("x1",0).attr("x2",t.width+t.histogramHeight+t.geneTrack.height).attr("opacity",0).attr("style","pointer-events: none"),t.container.on("mousedown",(function(){t.startSelection(this)})).on("mouseover",(function(t){e("mouseover",t)})).on("mousemove",(function(t){e("mousemove",t)})).on("mouseout",(function(){t.crosshair&&(t.verticalCross.attr("opacity",0),t.horizontalCross.attr("opacity",0))})).on("mouseup",(function(e){t.finishSelection(e)}))},g.prototype.startSelection=function(t){let e=this;if(e.crosshair&&void 0===e.selectionRegion){t.stopPropagation();let r=d3.pointer(t);e.selectionRegion=e.container.append("rect").attr("x",r[0]).attr("y",r[1]).attr("width",1).attr("height",1).attr("class",e.prefix+"selection-region").attr("stroke","black").attr("stroke-width","2").attr("opacity",.2)}},g.prototype.changeSelection=function(t){let e={x:parseInt(this.selectionRegion.attr("x"),10),y:parseInt(this.selectionRegion.attr("y"),10),width:parseInt(this.selectionRegion.attr("width"),10),height:parseInt(this.selectionRegion.attr("height"),10)},r={x:t[0]-Number(this.selectionRegion.attr("x")),y:t[1]-Number(this.selectionRegion.attr("y"))};r.x<1||2*r.x<e.width?(e.x=t[0],e.width-=r.x):e.width=r.x,r.y<1||2*r.y<e.height?(e.y=t[1],e.height-=r.y):e.height=r.y,this.selectionRegion.attr(e)},g.prototype.finishSelection=function(t){let e=this;if(e.crosshair&&void 0!==e.selectionRegion){t.stopPropagation();let r=Number(e.selectionRegion.attr("x")),n=r+Number(e.selectionRegion.attr("width")),i=Number(e.selectionRegion.attr("y")),o=i+Number(e.selectionRegion.attr("height")),a=e.rangeToDomain(e.x,r),s=e.rangeToDomain(e.x,n),c=e.rangeToDomain(e.y,i),l=e.rangeToDomain(e.y,o);e.sliceDonors(a,s),e.sliceGenes(c,l),e.selectionRegion.remove(),delete e.selectionRegion,e.fullscreen||e.resize(e.inputWidth,e.inputHeight),e.updateCallback(!0)}},g.prototype.sliceGenes=function(t,e){let r=this;for(let n=0;n<r.genes.length;n++){let i=r.genes[n];(n<t||n>e)&&(d3.selectAll("."+r.prefix+i.id+"-cell").remove(),d3.selectAll("."+r.prefix+i.id+"-bar").remove(),r.genes.splice(n,1),n--,t--,e--)}},g.prototype.sliceDonors=function(t,e){let r=this;for(let n=0;n<r.donors.length;n++){let i=r.donors[n];(n<t||n>e)&&(d3.selectAll("."+r.prefix+i.id+"-cell").remove(),d3.selectAll("."+r.prefix+i.id+"-bar").remove(),r.donors.splice(n,1),n--,t--,e--)}},g.prototype.defineRowDragBehaviour=function(){let t=this,e=d3.drag();e.on("start",(function(t){t.sourceEvent.stopPropagation()})),e.on("drag",(function(t){let e=t.dy;d3.select(t.target).attr("transform",(function(){let r=d3.transform(d3.select(t.target).attr("transform"));return"translate( 0, "+(parseInt(r.translate[1])+e)+")"}))})),e.on("end",(function(e,r){let n=d3.pointer(e,t.container.node()),i=t.genes.indexOf(r),o=t.rangeToDomain(t.y,n[1]);t.genes.splice(i,1),t.genes.splice(o,0,r),t.updateCallback(!0)})),t.row.call(e).on("click",(function(t){t.defaultPrevented})),t.row.on("mouseover",(function(){let e=this;void 0!==e.timeout&&clearTimeout(e.timeout),d3.select(this).select("."+t.prefix+"remove-gene").attr("style","display: block")})),t.row.on("mouseout",(function(){let e=this;e.timeout=setTimeout((function(){d3.select(e).select("."+t.prefix+"remove-gene").attr("style","display: none")}),500)}))},g.prototype.getY=function(t){let e=this,r=e.genes.map((function(t){return t.id}));if(!0===e.heatMap)return e.y(r.indexOf(t.geneId));let n=e.lookupTable[t.donorId][t.geneId];return e.y(r.indexOf(t.geneId))+e.cellHeight/n.length*n.indexOf(t.id)},g.prototype.getColor=function(t){let e=this;return!0===e.heatMap?"#D33682":e.colorMap[t.consequence]},g.prototype.getOpacity=function(t){return!0===this.heatMap?.25:1},g.prototype.getHeight=function(t){let e=this;if(void 0!==t){if(!0===e.heatMap)return e.cellHeight;{let r=e.lookupTable[t.donorId][t.geneId].length;return e.cellHeight/r}}return 0},g.prototype.toggleHeatmap=function(){let t=this;return t.heatMap=!0!==t.heatMap,d3.selectAll("."+t.prefix+"sortable-rect").transition().attr("y",(function(e){return t.getY(e)})).attr("height",(function(e){return t.getHeight(e)})).attr("fill",(function(e){return t.getColor(e)})).attr("opacity",(function(e){return t.getOpacity(e)})),t.heatMap},g.prototype.toggleGridLines=function(){return this.drawGridLines=!this.drawGridLines,this.geneTrack.toggleGridLines(),this.donorTrack.toggleGridLines(),this.computeCoordinates(),this.drawGridLines},g.prototype.toggleCrosshair=function(){return this.crosshair=!this.crosshair,this.crosshair},g.prototype.getDonorIndex=function(t,e){for(let r=0;r<t.length;r++){if(t[r].id===e)return r}return-1},g.prototype.removeGene=function(t){let e=this,r=e.genes[t];r&&(d3.selectAll("."+e.prefix+r.id+"-cell").remove(),d3.selectAll("."+e.prefix+r.id+"-bar").remove(),e.genes.splice(t,1)),e.updateCallback(!0)},g.prototype.rangeToDomain=function(t,e){return t.domain()[d3.bisect(t.range(),e)-1]},g.prototype.nullableObsLookup=function(t,e){let r=this;return t&&"object"==typeof t&&e&&"object"==typeof e&&r.lookupTable.hasOwnProperty(t.id)&&r.lookupTable[t.id].hasOwnProperty(e.id)?r.lookupTable[t.id][e.id].join(", "):null},g.prototype.destroy=function(){this.wrapper.select("."+this.prefix+"maingrid-svg").remove(),this.wrapper.select("."+this.prefix+"canvas").remove(),this.wrapper.select("."+this.prefix+"tooltip-oncogrid").remove()};var y=g,m=r(6),v=r.n(m),b=r(2),w=r.n(b),x=r(7);let k=function(t){this.params=t,this.inputWidth=t.width||500,this.inputHeight=t.height||500,this.prefix=t.prefix||"og-",t.wrapper="."+this.prefix+"container",d3.select(t.element||"body").append("div").attr("class",this.prefix+"container").style("position","relative"),this.initCharts(),w.a.call(this)};r.n(x).a.inherits(k,w.a),k.prototype.initCharts=function(){let t=this;t.clonedParams=i()(t.params),t.donors=t.clonedParams.donors||[],t.genes=t.clonedParams.genes||[],t.observations=t.clonedParams.observations||[],t.createLookupTable(),t.computeDonorCounts(),t.computeGeneScoresAndCount(),t.genesSortbyScores(),t.computeScores(),t.sortByScores(),t.mainGrid=new y(t.clonedParams,t.lookupTable,t.update(t),(function(){t.resize(t.inputWidth,t.inputHeight,t.fullscreen)}),t.emit.bind(t)),t.heatMapMode=t.mainGrid.heatMap,t.drawGridLines=t.mainGrid.drawGridLines,t.crosshairMode=t.mainGrid.crosshair,t.charts=[],t.charts.push(t.mainGrid)},k.prototype.createLookupTable=function(){let t=this,e={};for(let r=0;r<t.observations.length;r++){let n=t.observations[r],i=n.donorId,o=n.geneId;e.hasOwnProperty(i)?e[i].hasOwnProperty(o)?e[i][o].push(n.id):e[i][o]=[n.id]:(e[i]={},e[i][o]=[n.id]),t.lookupTable=e}},k.prototype.render=function(){let t=this;t.emit("render:all:start"),setTimeout((function(){t.charts.forEach((function(t){t.render()})),t.emit("render:all:end")}))},k.prototype.update=function(t){let e=t;return function(t){(t=null!=t&&t)&&(e.computeScores(),e.sortByScores()),e.charts.forEach((function(t){t.update()}))}},k.prototype.resize=function(t,e,r){this.fullscreen=r,this.mainGrid.fullscreen=r,this.charts.forEach((function(n){n.fullscreen=r,n.resize(Number(t),Number(e))}))},k.prototype.sortByScores=function(){this.donors.sort(this.sortScore)},k.prototype.genesSortbyScores=function(){this.genes.sort(this.sortScore)},k.prototype.getDonorIndex=function(t,e){for(let r=0;r<t.length;r++){if(t[r].id===e)return r}return-1},k.prototype.cluster=function(){this.genesSortbyScores(),this.computeScores(),this.sortByScores(),this.update(this)()},k.prototype.removeDonors=function(t){let e=this,r=[];for(let n=0;n<e.donors.length;n++){let i=e.donors[n];t(i)&&(r.push(i.id),d3.selectAll("."+e.prefix+i.id+"-cell").remove(),d3.selectAll("."+e.prefix+i.id+"-bar").remove(),e.donors.splice(n,1),n--)}for(let t=0;t<e.observations.length;t++){let r=e.observations[t];e.donors.indexOf(r.id)>=0&&(e.observations.splice(t,1),t--)}e.computeGeneScoresAndCount(),e.update(e)(),e.resize(e.inputWidth,e.inputHeight,!1)},k.prototype.removeGenes=function(t){let e=this,r=[];for(let n=0;n<e.genes.length;n++){let i=e.genes[n];t(i)&&(r.push(i.id),d3.selectAll("."+e.prefix+i.id+"-cell").remove(),d3.selectAll("."+e.prefix+i.id+"-bar").remove(),e.genes.splice(n,1),n--)}e.update(e)(),e.resize(e.inputWidth,e.inputHeight,!1)},k.prototype.sortDonors=function(t){this.donors.sort(t),this.update(this)()},k.prototype.sortGenes=function(t){this.computeScores(),this.sortByScores(),this.genes.sort(t),this.update(this)()},k.prototype.toggleHeatmap=function(){this.heatMapMode=this.mainGrid.toggleHeatmap()},k.prototype.toggleGridLines=function(){this.drawGridLines=this.mainGrid.toggleGridLines()},k.prototype.toggleCrosshair=function(){this.crosshairMode=this.mainGrid.toggleCrosshair()},k.prototype.mutationScore=function(t,e){return this.lookupTable.hasOwnProperty(t)&&this.lookupTable[t].hasOwnProperty(e)?1:0},k.prototype.mutationGeneScore=function(t,e){let r=this;return r.lookupTable.hasOwnProperty(t)&&r.lookupTable[t].hasOwnProperty(e)?r.lookupTable[t][e].length:0},k.prototype.computeScores=function(){let t=this;for(let e=0;e<t.donors.length;e++){let r=t.donors[e];r.score=0;for(let e=0;e<t.genes.length;e++){let n=t.genes[e];r.score+=t.mutationScore(r.id,n.id)*Math.pow(2,t.genes.length+1-e)}}},k.prototype.computeGeneScoresAndCount=function(){let t=this;for(let e=0;e<t.genes.length;e++){let r=t.genes[e];r.score=0;for(let e=0;e<t.donors.length;e++){let n=t.donors[e];r.score+=t.mutationGeneScore(n.id,r.id)}r.count=r.score}},k.prototype.computeDonorCounts=function(){let t=this;for(let e=0;e<t.donors.length;e++){let r=t.donors[e],n=v()(t.lookupTable[r.id]||{});r.count=0;for(let t=0;t<n.length;t++)r.count+=n[t].length}},k.prototype.computeGeneCounts=function(){let t=this;for(let e=0;e<t.genes.length;e++){let r=t.genes[e];r.count=0;for(let e=0;e<t.observations.length;e++){let n=t.observations[e];r.id===n.geneId&&(r.count+=1)}}},k.prototype.sortScore=function(t,e){return t.score<e.score?1:t.score>e.score?-1:t.id>=e.id?1:-1},k.prototype.destroy=function(){this.charts.forEach((function(t){t.destroy()}))},k.prototype.reload=function(){this.destroy(),this.initCharts(),this.render()};var j=k;window.OncoGrid=j}]);
//# sourceMappingURL=oncogrid.min.js.map